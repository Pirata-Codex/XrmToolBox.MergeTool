using System;
using System.Buffers.Text;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.IO;
using System.Linq;
using System.Reflection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace XrmToolBox.MergeTool
{
    // Do not forget to update version number and author (company attribute) in AssemblyInfo.cs class
    // To generate Base64 string for Images below, you can use https://www.base64-image.de/
    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Record Merge Tool"),
        ExportMetadata("Description", "A comprehensive tool to merge out-of-the-box and custom entity records in dynamics 365"),
        // Please specify the base64 content of a 32x32 pixels image
        ExportMetadata("SmallImageBase64", "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vLDwG/eE8/s3BCkeAAAACXBIWXMAAC4iAAAuIgGq4t2SAAADaGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5Bc3VzSXJhbjwvcmRmOmxpPjwvcmRmOlNlcT4NCgkJCTwvZGM6Y3JlYXRvcj48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj48ZXhpZjpEYXRlVGltZU9yaWdpbmFsPjIwMjUtMDEtMTBUMTE6Mzg6NTIuMjkwPC9leGlmOkRhdGVUaW1lT3JpZ2luYWw+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPjx4bXA6Q3JlYXRlRGF0ZT4yMDI1LTAxLTEwVDExOjM4OjUyLjI5MDwveG1wOkNyZWF0ZURhdGU+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KPD94cGFj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"),
        // Please specify the base64 content of a 80x80 pixels image
        ExportMetadata("BigImageBase64", "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vLDwG/eE8/s3BCkeAAAACXBIWXMAAC4iAAAuIgGq4t2SAAADaGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5Bc3VzSXJhbjwvcmRmOmxpPjwvcmRmOlNlcT4NCgkJCTwvZGM6Y3JlYXRvcj48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj48ZXhpZjpEYXRlVGltZU9yaWdpbmFsPjIwMjUtMDEtMTBUMTE6Mzg6NTIuMjkwPC9leGlmOkRhdGVUaW1lT3JpZ2luYWw+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPjx4bXA6Q3JlYXRlRGF0ZT4yMDI1LTAxLTEwVDExOjM4OjUyLjI5MDwveG1wOkNyZWF0ZURhdGU+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KPD94cGFj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"),
        ExportMetadata("BackgroundColor", "Lavender"),
        ExportMetadata("PrimaryFontColor", "Black"),
        ExportMetadata("SecondaryFontColor", "Gray")]
    public class MyPlugin : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new MyPluginControl();
        }

        /// <summary>
        /// Constructor 
        /// </summary>
        public MyPlugin()
        {
            // If you have external assemblies that you need to load, uncomment the following to 
            // hook into the event that will fire when an Assembly fails to resolve
             AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(AssemblyResolveEventHandler);
        }

        /// <summary>
        /// Event fired by CLR when an assembly reference fails to load
        /// Assumes that related assemblies will be loaded from a subfolder named the same as the Plugin
        /// For example, a folder named Sample.XrmToolBox.MyPlugin 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        /// <returns></returns>
        private Assembly AssemblyResolveEventHandler(object sender, ResolveEventArgs args)
        {
            Assembly loadAssembly = null;
            Assembly currAssembly = Assembly.GetExecutingAssembly();

            // base name of the assembly that failed to resolve
            var argName = args.Name.Substring(0, args.Name.IndexOf(","));

            // check to see if the failing assembly is one that we reference.
            List<AssemblyName> refAssemblies = currAssembly.GetReferencedAssemblies().ToList();
            var refAssembly = refAssemblies.Where(a => a.Name == argName).FirstOrDefault();

            // if the current unresolved assembly is referenced by our plugin, attempt to load
            if (refAssembly != null)
            {
                // load from the path to this plugin assembly, not host executable
                string dir = Path.GetDirectoryName(currAssembly.Location).ToLower();
                string folder = Path.GetFileNameWithoutExtension(currAssembly.Location);
                dir = Path.Combine(dir, folder);

                var assmbPath = Path.Combine(dir, $"{argName}.dll");

                if (File.Exists(assmbPath))
                {
                    loadAssembly = Assembly.LoadFrom(assmbPath);
                }
                else
                {
                    throw new FileNotFoundException($"Unable to locate dependency: {assmbPath}");
                }
            }

            return loadAssembly;
        }
    }
}